#!/usr/bin/env node
var ethen = require('ethen');
var argv = require('minimist')(process.argv.slice(2));

if (argv.help) {
  var help = 'Usage <host> [port] \n'
  + 'Starts the web UI server \n'
  + '  <port>  The port the this server is listening to'
  + '  <host>  This host that this server is listening to. Defailts to localhost';

  console.log(help);
  process.exit();
}

if(!argv._[0]){
  console.log('<port> is required');
  process.exit();
}

var port = argv._[0];
var host = argv._[1];
var isShutingDown = false;

console.log('webUI server - started: /: ' + port);
ethen.start(port, host);
  // } else if (m.command === 'stop') {
  //   ethen.stop(function() {
  //     process.send('done');
  //   });
  // }
// });

process.once('SIGTERM', shutdown);
process.once('SIGINT', shutdown);

function shutdown (){
  if(!isShutingDown){
    isShutingDown = true;
    ethen.stop(function(){
      console.log('webUI server stopped');
      if(process.send){
        process.send('shutDown');
      }
    });
  }
}
